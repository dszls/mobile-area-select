/*
 Minified by Uglify 2015-40-18-16:11:26*/
!function(a){"function"==typeof define&&define.amd?define(["$"],a):"object"==typeof module&&module&&"object"==typeof module.exports?module.exports=a():a(window.Zepto||window.jQuery||$)}(function(a){a.fn.mobileAreaSelect=function(b){var c=Math.random().toString().replace(".",""),d=a.extend({id:"dialog_"+c,data:"address.json",index:0,value:[],text:[],level:3,mtop:30,separator:" ",isMaskClose:!0,closeBtn:".js-close",dialog:".select-dialog",onChange:a.noop},b),e=function(a){a.stopPropagation(),a.preventDefault()},f={init:function(b){this.index=d.index,this.mtop=d.mtop,this.value=d.value,this.oldvalue=this.value.concat([]),this.text=d.text,this.level=d.level,this.scroller=a("#"+d.id).find(".select-scroll ul"),this.$ms=a(b),this.getData(),this.createHtml(),this.bindEvent()},getData:function(){var b=this;"object"==typeof d.data?this.data=d.data:a.ajax({dataType:"json",cache:!0,url:d.data,type:"GET",success:function(a){b.data=a.data},accepts:{json:"application/json, text/javascript, */*; q=0.01"}})},bindEvent:function(){var b=this;this.$ms.on("click",function(){a("body").append(b.htmlStr),a("html").on("touchmove.popBlur",e),b.scroller=a("#"+d.id).find(".select-scroll ul"),b.format();var c=0,f=0;b.scroller.children().on("touchstart",function(a){c=a.originalEvent?a.originalEvent.changedTouches[0].pageY:a.changedTouches[0].pageY}),b.scroller.children().on("touchmove",function(b){f=b.originalEvent?b.originalEvent.changedTouches[0].pageY:b.changedTouches[0].pageY;var d=f-c,e=a(b.target).parent();if("DL"==e[0].nodeName){var g=parseInt(e.css("top")||0)+d;return e.css("top",g),c=f,!1}}),b.scroller.children().on("touchend",function(d){f=d.originalEvent?d.originalEvent.changedTouches[0].pageY:d.changedTouches[0].pageY;var e=f-c,g=a(d.target).parent();if("DL"==g[0].nodeName){var h=a(g.parent()).index(),i=parseInt(g.css("top")||0)+e;i>b.mtop&&(i=b.mtop),i<-a(g).height()+60&&(i=-a(g).height()+60);var j=i/b.mtop,k=Math.round(j),l=Math.abs(k)+1;1==k&&(l=0),b.value[h]=a(g.children().get(l)).attr("ref"),b.text[h]=0==b.value[h]?"":a(g.children().get(l)).html();for(var m=b.level-1;m>h;m--)b.value[m]=0,b.text[m]="";return a(g.children().get(l)).hasClass("focus")||b.format(),a(g.children().get(l)).addClass("focus").siblings().removeClass("focus"),g.css("top",k*b.mtop),!1}})}),a("body").on("click","#"+d.id,function(c){a.contains(c.target,a(this).find(".select-cnt")[0])&&d.isMaskClose&&b.close(),a(c.target).hasClass("js-submit")&&b.submit(),a(c.target).hasClass("js-close")&&b.close()})},createHtml:function(){for(var a='<div class="select-dialog show" id="'+d.id+'"><div class="select-cnt"><div class="select-scroll"><ul>',b=1;b<=d.level;b++)a+="<li></li>";a+='</ul><p></p></div><div class="select-action"><button class="b-submit js-submit">确定</button><button class="b-cencel js-close">取消</button></div></div></div>',this.htmlStr=a},format:function(){this.f(this.data)},f:function(b){var c=this,d=b;d||(d=[]);var e,f='<dl><dd ref="0">请选择</dd>',g=0,h=c.mtop;if(0!==c.index&&"0"==c.value[c.index-1])f='<dl><dd ref="0" class="focus">请选择</dd>',c.value[c.index]=0,c.text[c.index]="",g=0;else{"0"==c.value[c.index]&&(f='<dl><dd ref="0" class="focus">请选择</dd>',g=0);for(var i=0,j=d.length;j>i;i++){var k=d[i].code||0,l="";c.value[c.index]==k&&(l="focus",g=k,e=d[i].cities||d[i].district,h=c.mtop*-i),f+='<dd class="'+l+'" ref="'+k+'">'+d[i].name+"</dd>"}}f+="</dl>";var m=a(f);m.css("top",h);var n=c.scroller.children();return a(n[c.index]).html(m),c.index++,c.index>c.level-1?void(c.index=0):void c.f(e)},submit:function(){this.oldvalue=this.value.concat([]),1==this.$ms[0].nodeType&&(this.$ms.val(this.text.join(d.separator)),this.$ms.attr("data-value",this.value.join(","))),this.$ms.next(":hidden").val(this.value.join(",")),this.close(),d.onChange.apply(this,arguments)},close:function(){this.value=this.oldvalue.concat([]),a("#"+d.id).addClass("hide"),a("#"+d.id).find(".select-cnt").on("webkitAnimationEnd.ashow",function(){a("#"+d.id).remove(),a(this).off(".ashow")}),a("html").off(".popBlur")}};return this.each(function(){f.init(this)})}});
/* Powered by https://github.com/dszls/mobile-area-select */