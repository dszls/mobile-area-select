/*
 Minified by Uglify 2016-47-27-11:12:05*/
!function(a){"function"==typeof define&&define.amd?define(["$"],a):"object"==typeof module&&module&&"object"==typeof module.exports?module.exports=a():a($)}(function(a){a.fn.mobileAreaSelect=function(b){var c=Math.random().toString().replace(".",""),d=a.extend({id:"dialog_"+c,data:"json/address.json",code:"code",name:"name",index:0,childName:"",value:[],text:[],level:3,mtop:30,separator:" ",isMaskClose:!0,closeBtn:".js-close",dialog:".select-dialog",onChange:a.noop,isDefault:!1},b),e=function(a){a.stopPropagation(),a.preventDefault()},f={init:function(b){this.index=d.index,this.mtop=d.mtop,this.value=d.value,this.oldvalue=this.value.concat([]),this.text=d.text,this.level=d.level,this.scroller=a("#"+d.id).find(".select-scroll ul"),this.$ms=a(b),this.getData(),this.createHtml(),this.bindEvent()},getData:function(){var b=this;"object"==typeof d.data?(this.data=d.data,this.defaultShow()):a.ajax({dataType:"json",cache:!0,url:d.data,type:"GET",success:function(a){b.data=a.data,b.defaultShow()},accepts:{json:"application/json, text/javascript, */*; q=0.01"}})},defaultShow:function(){var a=this;d.isDefault&&(a.format(),"INPUT"==a.$ms[0].nodeName?a.$ms.val(a.text.join(d.separator)):a.$ms.find("span").text(a.text.join(d.separator)),a.$ms.attr("data-value",a.value.join(",")),a.$ms.attr("data-text",a.text.join(d.separator)),d.onChange.apply(a,arguments))},bindEvent:function(){var b=this;this.$ms.on("click",function(c){"INPUT"==this.tagName&&this.blur(),a("body").append(b.htmlStr),b.mtop=a(".select-cnt .select-scroll p").height()+2,a("html").on("touchmove.popBlur",e),b.scroller=a("#"+d.id).find(".select-scroll ul"),b.format();var f=0,g=0;b.scroller.children().on("touchstart",function(a){f=a.originalEvent?a.originalEvent.changedTouches[0].pageY:a.changedTouches[0].pageY}),b.scroller.children().on("touchmove",function(b){g=b.originalEvent?b.originalEvent.changedTouches[0].pageY:b.changedTouches[0].pageY;var c=g-f,d=a(b.target).parent();if("DL"==d[0].nodeName){var e=parseInt(d.css("top")||0)+c;return d.css("top",e),f=g,!1}}),b.scroller.children().on("touchend",function(c){g=c.originalEvent?c.originalEvent.changedTouches[0].pageY:c.changedTouches[0].pageY;var d=g-f,e=a(c.target).parent();if("DL"==e[0].nodeName){var h=a(e.parent()).index(),i=parseInt(e.css("top")||0)+d;i>b.mtop&&(i=b.mtop),i<-a(e).height()+60&&(i=-a(e).height()+60);var j=i/b.mtop,k=Math.round(j),l=Math.abs(k)+1;1==k&&(l=0),b.value[h]=a(e.children().get(l)).attr("ref"),0==b.value[h]?b.text[h]="":b.text[h]=a(e.children().get(l)).html();for(var m=b.level-1;m>h;m--)b.value[m]=0,b.text[m]="";return a(e.children().get(l)).hasClass("focus")||b.format(),a(e.children().get(l)).addClass("focus").siblings().removeClass("focus"),e.css("top",k*b.mtop),!1}})}),a("body").on("click","#"+d.id,function(c){a.contains(c.target,a(this).find(".select-cnt")[0])&&d.isMaskClose&&b.close(),a(c.target).hasClass("js-submit")&&b.submit(),a(c.target).hasClass("js-close")&&b.close()})},createHtml:function(){for(var a='<div class="select-dialog show" id="'+d.id+'"><div class="select-cnt"><div class="select-action"><button class="b-cencel js-close">取消</button><button class="b-submit js-submit">确定</button></div><div class="select-scroll"><ul>',b=1;b<=d.level;b++)a+='<li style="width:'+100/d.level+'%"></li>';a+="</ul><p></p></div></div></div>",this.htmlStr=a},format:function(){this.f(this.data)},f:function(b){var c=this,e=b;e||(e=[]);var f,g='<dl><dd ref="0">请选择</dd>',h=0,i=c.mtop;if(0!==c.index&&"0"==c.value[c.index-1])g='<dl><dd ref="0" class="focus">请选择</dd>',c.value[c.index]=0,c.text[c.index]="",h=0;else{"0"==c.value[c.index]&&(g='<dl><dd ref="0" class="focus">请选择</dd>',h=0);for(var j=0,k=e.length;k>j;j++){var l=e[j][d.code]||0,m="";c.value[c.index]==l&&(m="focus",h=l,f=e[j].cities||e[j].district||e[j][d.childName],i=c.mtop*-j,d.isDefault&&(c.text[c.index]=e[j][d.name])),g+='<dd style="height:'+this.mtop+"px;line-height:"+this.mtop+'px;" class="'+m+'" ref="'+l+'">'+e[j][d.name]+"</dd>"}}g+="</dl>";var n=a(g);n.css("top",i);var o=c.scroller.children();return a(o[c.index]).html(n),c.index++,c.index>c.level-1?void(c.index=0):void c.f(f)},submit:function(){this.oldvalue=this.value.concat([]),"INPUT"==this.$ms[0].nodeName?this.$ms.val(this.text.join(d.separator)):this.$ms.find("span").text(this.text.join(d.separator)),this.$ms.attr("data-value",this.value.join(",")),this.$ms.attr("data-text",this.text.join(d.separator)),this.close(),d.onChange.apply(this,arguments)},close:function(){this.value=this.oldvalue.concat([]),a("#"+d.id).remove(),a("html").off(".popBlur")}};return this.each(function(){f.init(this)})}});
/* Powered by https://github.com/dszls/mobile-area-select */